<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Vidar Rave DJ</title>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose"></script>
  <script src="https://cdn.jsdelivr.net/npm/tone"></script>
  <style>body{margin:0;background:#000;overflow:hidden}</style>
</head>
<body>
<video id="vid" style="position:absolute;width:100%;height:100%;object-fit:cover;transform:scaleX(-1)"></video>
<h1 style="position:absolute;top:30px;left:0;width:100%;text-align:center;color:#0ff;font-size:2.5em;text-shadow:0 0 20px #0ff;z-index:2">
  JUMP = KICK
</h1>

<script>
const video = document.getElementById('vid');
navigator.mediaDevices.getUserMedia({video: {facingMode: "user"}}).then(s => {
  video.srcObject = s;
  video.play();
});

const pose = new Pose({locateFile: f => `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${f}`});
pose.setOptions({modelComplexity: 1, smoothLandmarks: true});

pose.onResults(results => {
  if (results.poseLandmarks) {
    const leftFoot = results.poseLandmarks[27].y;
    const rightFoot = results.poseLandmarks[28].y;
    if (leftFoot < 0.45 && rightFoot < 0.45) {  // you jumped
      new Tone.Player("https://cdn.freesound.org/previews/467/467947_5121236-lq.mp3").toDestination().start();
    }
  }
});

const camera = new Camera(video, {
  onFrame: async () => await pose.send({image: video})
});
camera.start();
</script>
</body>
</html>